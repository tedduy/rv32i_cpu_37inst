# Simulation Directory

This directory contains all simulation scripts, logs, and verification reports for the RV32I CPU project.

## Directory Structure

```
sim/
├── scripts/              # All TCL automation scripts
│   ├── compile/         # Compilation scripts
│   │   └── compile.tcl  # Compile RTL and testbench
│   ├── run/             # Simulation runners
│   │   ├── run_sim.tcl          # Run pipeline/single-cycle simulation
│   │   └── debug_pipeline.tcl   # Launch GUI debugger with waveforms
│   ├── verify/          # Verification scripts
│   │   ├── verify_pipeline.tcl           # Compare SC vs PL execution
│   │   ├── verify_final_state.tcl        # Compare final register/memory state
│   │   ├── full_verify.tcl               # Complete verification workflow
│   │   └── run_complete_verification.tcl # Alternative verification
│   ├── uvm/             # UVM testing scripts
│   │   ├── compile_uvm.tcl           # Compile UVM testbench
│   │   ├── run_uvm.tcl               # Run individual UVM test
│   │   ├── run_uvm_regression.tcl    # Run UVM regression suite
│   │   └── analyze_uvm_coverage.tcl  # Analyze coverage results
│   ├── filelist.f       # RTL file list
│   └── TCL_WORKFLOW_README.md  # Detailed TCL workflow guide
├── logs/                # Simulation logs
│   ├── pipeline_output.log
│   └── single_cycle_output.log
├── reports/             # Verification reports
│   ├── pl_final_regs.txt   # Pipeline final register state
│   ├── pl_final_mem.txt    # Pipeline final memory state
│   ├── sc_final_regs.txt   # Single-cycle final register state
│   └── sc_final_mem.txt    # Single-cycle final memory state
├── coverage/            # Coverage databases and reports
│   ├── *.ucdb          # Coverage databases (generated by UVM tests)
│   └── html/           # HTML coverage reports
├── waveforms/           # Waveform files
│   └── *.wlf           # QuestaSim waveform files
└── work/                # QuestaSim work library (auto-generated)
```

## Quick Start

### Basic Simulation
```bash
# From project root
make compile          # Compile RTL
make sim              # Run pipeline simulation
make gui              # Run with GUI
make debug            # Debug with pre-loaded waveforms
```

### Verification
```bash
make verify           # Full verification (SC vs PL)
make verify-quick     # Quick pipeline verification
make verify-final     # Final state verification only
```

### Direct TCL Usage
```bash
cd sim

# Compilation
vsim -c -do "do scripts/compile/compile.tcl; quit -f"

# Run simulation
vsim -do "do scripts/run/run_sim.tcl -mode pipeline"

# Debug with GUI
vsim -do "do scripts/run/debug_pipeline.tcl"

# Verification
tclsh scripts/verify/full_verify.tcl
```

### UVM Testing (Future)
```bash
cd sim

# Compile UVM testbench
vsim -c -do "do scripts/uvm/compile_uvm.tcl; quit -f"

# Run single test
vsim -do "do scripts/uvm/run_uvm.tcl -test=rv32i_base_test"

# Run regression
tclsh scripts/uvm/run_uvm_regression.tcl

# Analyze coverage
tclsh scripts/uvm/analyze_uvm_coverage.tcl
```

## Output Files

### Logs (`logs/`)
- `pipeline_output.log` - Pipeline mode execution trace
- `single_cycle_output.log` - Single-cycle mode execution trace

### Reports (`reports/`)
- `*_final_regs.txt` - Final register state dumps
- `*_final_mem.txt` - Final memory state dumps
- Verification comparison reports

### Coverage (`coverage/`)
- `*.ucdb` - QuestaSim coverage databases
- `html/` - Interactive HTML coverage reports

### Waveforms (`waveforms/`)
- `*.wlf` - QuestaSim waveform files for debugging

## Script Categories

### Compile Scripts
- **Purpose**: Compile RTL and testbench files
- **Location**: `scripts/compile/`
- **When to use**: Before running any simulation

### Run Scripts
- **Purpose**: Execute simulations
- **Location**: `scripts/run/`
- **When to use**: To run or debug the design

### Verify Scripts
- **Purpose**: Verify correctness by comparing modes
- **Location**: `scripts/verify/`
- **When to use**: To validate pipeline against single-cycle

### UVM Scripts
- **Purpose**: Advanced verification with UVM
- **Location**: `scripts/uvm/`
- **When to use**: For constrained-random testing and coverage

## Clean Up

```bash
make clean            # Remove generated files
# or
cd sim
rm -rf work/ logs/* reports/* coverage/* waveforms/* transcript
```

## Documentation

For more information:
- **Project Overview**: `../README.md`
- **Pipeline Architecture**: `../docs/PIPELINE_ARCHITECTURE.md`
- **TCL Workflow Guide**: `scripts/TCL_WORKFLOW_README.md`
- **Make Targets**: Run `make help` from project root
